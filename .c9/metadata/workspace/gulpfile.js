{"changed":true,"filter":false,"title":"gulpfile.js","tooltip":"/gulpfile.js","value":"var gulp = require('gulp')\n  , gutil = require('gulp-util')\n  , del = require('del')\n  , concat = require('gulp-concat')\n  , rename = require('gulp-rename')\n  , minifycss = require('gulp-minify-css')\n  , minifyhtml = require('gulp-minify-html')\n  , processhtml = require('gulp-processhtml')\n  , jshint = require('gulp-jshint')\n  , streamify = require('gulp-streamify')\n  , uglify = require('gulp-uglify')\n  , connect = require('gulp-connect')\n  , source = require('vinyl-source-stream')\n  , browserify = require('browserify')\n  , watchify = require('watchify')\n  , gulpif = require('gulp-if')\n  , vinylPaths = require('vinyl-paths')\n  , ts = require('gulp-typescript')\n  , tsify = require('tsify')\n  , tsProject = ts.createProject('tsconfig.json')\n  , paths;\n\npaths = {\n  assets: 'src/assets/**/*',\n  css:    'src/css/*.css', \n  libs:   [\n    'src/bower_components/phaser-official/build/phaser.min.js'\n  ],\n  js:     ['src/js/**/*.js'],\n  entry:  './src/js/main.js',\n  dist:   './dist/'\n};\n\ngulp.task('clean', function () {\n\treturn gulp.src(paths.dist)\n    .pipe(vinylPaths(del))\n    .on('error', gutil.log);\n});\n\ngulp.task('copy', ['clean'], function () {\n  gulp.src(paths.assets)\n    .pipe(gulp.dest(paths.dist + 'assets'))\n    .on('error', gutil.log);\n});\n\ngulp.task('copylibs', ['clean'], function () {\n  gulp.src(paths.libs)\n    .pipe(gulpif(!watching, uglify({outSourceMaps: false})))\n    .pipe(gulp.dest(paths.dist + 'js/lib'))\n    .on('error', gutil.log);\n});\n\ngulp.task('compile', ['clean'], function () {\n  var bundler = browserify({\n    cache: {}, packageCache: {}, fullPaths: true,\n    entries: [paths.entry],\n    debug: watching\n  })\n  .plugin(tsify);\n\n  var bundlee = function() {\n    return bundler\n      .bundle()\n      .pipe(source('main.min.js'))\n      .pipe(jshint('.jshintrc'))\n      .pipe(jshint.reporter('default'))\n      .pipe(gulpif(!watching, streamify(uglify({outSourceMaps: false}))))\n      .pipe(gulp.dest(paths.dist))\n      .on('error', gutil.log);\n  };\n\n  if (watching) {\n    bundler = watchify(bundler);\n    bundler.on('update', bundlee)\n  }\n\n  return bundlee();\n});\n\ngulp.task('minifycss', ['clean'], function () {\n gulp.src(paths.css)\n    .pipe(gulpif(!watching, minifycss({\n      keepSpecialComments: false,\n      removeEmpty: true\n    })))\n    .pipe(rename({suffix: '.min'}))\n    .pipe(gulp.dest(paths.dist))\n    .on('error', gutil.log);\n});\n\ngulp.task('processhtml', ['clean'], function() {\n  return gulp.src('src/index.html')\n    .pipe(processhtml('index.html'))\n    .pipe(gulp.dest(paths.dist))\n    .on('error', gutil.log);\n});\n\ngulp.task('minifyhtml', ['processhtml'], function() {\n  gulp.src('dist/index.html')\n    .pipe(gulpif(!watching, minifyhtml()))\n    .pipe(gulp.dest(paths.dist))\n    .on('error', gutil.log);\n});\n\ngulp.task('html', ['build'], function(){\n  gulp.src('dist/*.html')\n    .pipe(connect.reload())\n    .on('error', gutil.log);\n});\n\ngulp.task('connect', function () {\n  connect.server({\n    root: ['./dist'],\n    host: process.env.IP,\n    port: process.env.PORT,\n    livereload: true\n  });\n});\n\ngulp.task('watch', function () {\n  watching = true;\n  return gulp.watch(['./src/index.html', paths.css, paths.js], ['build', 'html']);\n});\n\ngulp.task('default', ['connect', 'watch', 'build']);\ngulp.task('build', ['clean', 'copy', 'copylibs', 'compile', 'minifycss', 'processhtml', 'minifyhtml']);\n\n","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":18,"column":37},"end":{"row":18,"column":38},"action":"insert","lines":["o"],"id":192}],[{"start":{"row":18,"column":38},"end":{"row":18,"column":39},"action":"insert","lines":["n"],"id":193}],[{"start":{"row":18,"column":39},"end":{"row":18,"column":40},"action":"insert","lines":["f"],"id":194}],[{"start":{"row":18,"column":40},"end":{"row":18,"column":41},"action":"insert","lines":["i"],"id":195}],[{"start":{"row":18,"column":41},"end":{"row":18,"column":42},"action":"insert","lines":["g"],"id":196}],[{"start":{"row":18,"column":42},"end":{"row":18,"column":43},"action":"insert","lines":["."],"id":197}],[{"start":{"row":18,"column":43},"end":{"row":18,"column":44},"action":"insert","lines":["j"],"id":198}],[{"start":{"row":18,"column":44},"end":{"row":18,"column":45},"action":"insert","lines":["s"],"id":199}],[{"start":{"row":18,"column":45},"end":{"row":18,"column":46},"action":"insert","lines":["o"],"id":200}],[{"start":{"row":18,"column":46},"end":{"row":18,"column":47},"action":"insert","lines":["n"],"id":201}],[{"start":{"row":39,"column":22},"end":{"row":39,"column":24},"action":"insert","lines":["()"],"id":202}],[{"start":{"row":39,"column":24},"end":{"row":40,"column":0},"action":"insert","lines":["",""],"id":203},{"start":{"row":40,"column":0},"end":{"row":40,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":40,"column":2},"end":{"row":40,"column":4},"action":"insert","lines":["  "],"id":204}],[{"start":{"row":40,"column":4},"end":{"row":40,"column":5},"action":"insert","lines":["."],"id":205}],[{"start":{"row":40,"column":5},"end":{"row":40,"column":6},"action":"insert","lines":["p"],"id":206}],[{"start":{"row":40,"column":6},"end":{"row":40,"column":7},"action":"insert","lines":["i"],"id":207}],[{"start":{"row":40,"column":7},"end":{"row":40,"column":8},"action":"insert","lines":["p"],"id":208}],[{"start":{"row":40,"column":8},"end":{"row":40,"column":9},"action":"insert","lines":["e"],"id":209}],[{"start":{"row":40,"column":9},"end":{"row":40,"column":11},"action":"insert","lines":["()"],"id":210}],[{"start":{"row":40,"column":10},"end":{"row":40,"column":11},"action":"insert","lines":["t"],"id":211}],[{"start":{"row":40,"column":11},"end":{"row":40,"column":12},"action":"insert","lines":["s"],"id":212}],[{"start":{"row":40,"column":12},"end":{"row":40,"column":14},"action":"insert","lines":["()"],"id":213}],[{"start":{"row":40,"column":13},"end":{"row":40,"column":14},"action":"insert","lines":["t"],"id":214}],[{"start":{"row":40,"column":14},"end":{"row":40,"column":15},"action":"insert","lines":["s"],"id":215}],[{"start":{"row":40,"column":15},"end":{"row":40,"column":16},"action":"insert","lines":["P"],"id":216}],[{"start":{"row":40,"column":13},"end":{"row":40,"column":16},"action":"remove","lines":["tsP"],"id":217},{"start":{"row":40,"column":13},"end":{"row":40,"column":22},"action":"insert","lines":["tsProject"]}],[{"start":{"row":40,"column":24},"end":{"row":41,"column":0},"action":"insert","lines":["",""],"id":218},{"start":{"row":41,"column":0},"end":{"row":41,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":41,"column":4},"end":{"row":41,"column":5},"action":"insert","lines":["."],"id":219}],[{"start":{"row":41,"column":5},"end":{"row":41,"column":6},"action":"insert","lines":["j"],"id":220}],[{"start":{"row":41,"column":6},"end":{"row":41,"column":7},"action":"insert","lines":["s"],"id":221}],[{"start":{"row":41,"column":7},"end":{"row":41,"column":8},"action":"insert","lines":["."],"id":222}],[{"start":{"row":41,"column":8},"end":{"row":41,"column":9},"action":"insert","lines":["p"],"id":223}],[{"start":{"row":41,"column":9},"end":{"row":41,"column":10},"action":"insert","lines":["i"],"id":224}],[{"start":{"row":41,"column":10},"end":{"row":41,"column":11},"action":"insert","lines":["p"],"id":225}],[{"start":{"row":41,"column":11},"end":{"row":41,"column":12},"action":"insert","lines":["e"],"id":226}],[{"start":{"row":41,"column":12},"end":{"row":41,"column":14},"action":"insert","lines":["()"],"id":227}],[{"start":{"row":41,"column":13},"end":{"row":41,"column":14},"action":"insert","lines":["g"],"id":228}],[{"start":{"row":41,"column":14},"end":{"row":41,"column":15},"action":"insert","lines":["u"],"id":229}],[{"start":{"row":41,"column":15},"end":{"row":41,"column":16},"action":"insert","lines":["l"],"id":230}],[{"start":{"row":41,"column":16},"end":{"row":41,"column":17},"action":"insert","lines":["p"],"id":231}],[{"start":{"row":41,"column":17},"end":{"row":41,"column":18},"action":"insert","lines":["."],"id":232}],[{"start":{"row":41,"column":18},"end":{"row":41,"column":19},"action":"insert","lines":["d"],"id":233}],[{"start":{"row":41,"column":19},"end":{"row":41,"column":20},"action":"insert","lines":["e"],"id":234}],[{"start":{"row":41,"column":20},"end":{"row":41,"column":21},"action":"insert","lines":["s"],"id":235}],[{"start":{"row":41,"column":21},"end":{"row":41,"column":22},"action":"insert","lines":["t"],"id":236}],[{"start":{"row":41,"column":22},"end":{"row":41,"column":24},"action":"insert","lines":["()"],"id":237}],[{"start":{"row":41,"column":23},"end":{"row":41,"column":25},"action":"insert","lines":["''"],"id":238}],[{"start":{"row":41,"column":24},"end":{"row":41,"column":25},"action":"remove","lines":["'"],"id":239}],[{"start":{"row":41,"column":23},"end":{"row":41,"column":24},"action":"remove","lines":["'"],"id":240}],[{"start":{"row":41,"column":23},"end":{"row":41,"column":24},"action":"insert","lines":["p"],"id":241}],[{"start":{"row":41,"column":24},"end":{"row":41,"column":25},"action":"insert","lines":["a"],"id":242}],[{"start":{"row":41,"column":25},"end":{"row":41,"column":26},"action":"insert","lines":["t"],"id":243}],[{"start":{"row":41,"column":26},"end":{"row":41,"column":27},"action":"insert","lines":["h"],"id":244}],[{"start":{"row":41,"column":27},"end":{"row":41,"column":28},"action":"insert","lines":["s"],"id":245}],[{"start":{"row":41,"column":28},"end":{"row":41,"column":29},"action":"insert","lines":["."],"id":246}],[{"start":{"row":41,"column":29},"end":{"row":41,"column":30},"action":"insert","lines":["d"],"id":247}],[{"start":{"row":41,"column":30},"end":{"row":41,"column":31},"action":"insert","lines":["i"],"id":248}],[{"start":{"row":41,"column":31},"end":{"row":41,"column":32},"action":"insert","lines":["s"],"id":249}],[{"start":{"row":41,"column":32},"end":{"row":41,"column":33},"action":"insert","lines":["t"],"id":250}],[{"start":{"row":41,"column":35},"end":{"row":41,"column":36},"action":"insert","lines":[";"],"id":251}],[{"start":{"row":38,"column":0},"end":{"row":42,"column":2},"action":"remove","lines":["gulp.task('compile', function(){","  return tsProject.src()","    .pipe(ts(tsProject))","    .js.pipe(gulp.dest(paths.dist));","})"],"id":252}],[{"start":{"row":37,"column":0},"end":{"row":38,"column":0},"action":"remove","lines":["",""],"id":253}],[{"start":{"row":37,"column":0},"end":{"row":38,"column":0},"action":"remove","lines":["",""],"id":254}],[{"start":{"row":56,"column":4},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":255},{"start":{"row":57,"column":0},"end":{"row":57,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":57,"column":2},"end":{"row":57,"column":3},"action":"insert","lines":["."],"id":256}],[{"start":{"row":57,"column":3},"end":{"row":57,"column":4},"action":"insert","lines":["p"],"id":257}],[{"start":{"row":57,"column":4},"end":{"row":57,"column":5},"action":"insert","lines":["l"],"id":258}],[{"start":{"row":57,"column":5},"end":{"row":57,"column":6},"action":"insert","lines":["u"],"id":259}],[{"start":{"row":57,"column":6},"end":{"row":57,"column":7},"action":"insert","lines":["g"],"id":260}],[{"start":{"row":57,"column":7},"end":{"row":57,"column":8},"action":"insert","lines":["i"],"id":261}],[{"start":{"row":57,"column":8},"end":{"row":57,"column":9},"action":"insert","lines":["n"],"id":262}],[{"start":{"row":57,"column":9},"end":{"row":57,"column":11},"action":"insert","lines":["()"],"id":263}],[{"start":{"row":57,"column":10},"end":{"row":57,"column":11},"action":"insert","lines":["t"],"id":264}],[{"start":{"row":57,"column":11},"end":{"row":57,"column":12},"action":"insert","lines":["s"],"id":265}],[{"start":{"row":57,"column":12},"end":{"row":57,"column":13},"action":"insert","lines":["i"],"id":266}],[{"start":{"row":57,"column":13},"end":{"row":57,"column":14},"action":"insert","lines":["f"],"id":267}],[{"start":{"row":57,"column":14},"end":{"row":57,"column":15},"action":"insert","lines":["y"],"id":268}],[{"start":{"row":17,"column":35},"end":{"row":18,"column":0},"action":"insert","lines":["",""],"id":269},{"start":{"row":18,"column":0},"end":{"row":18,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":18,"column":2},"end":{"row":18,"column":3},"action":"insert","lines":[","],"id":270}],[{"start":{"row":18,"column":3},"end":{"row":18,"column":4},"action":"insert","lines":[" "],"id":271}],[{"start":{"row":18,"column":4},"end":{"row":18,"column":5},"action":"insert","lines":["t"],"id":272}],[{"start":{"row":18,"column":5},"end":{"row":18,"column":6},"action":"insert","lines":["s"],"id":273}],[{"start":{"row":18,"column":6},"end":{"row":18,"column":7},"action":"insert","lines":["i"],"id":274}],[{"start":{"row":18,"column":7},"end":{"row":18,"column":8},"action":"insert","lines":["f"],"id":275}],[{"start":{"row":18,"column":8},"end":{"row":18,"column":9},"action":"insert","lines":["y"],"id":276}],[{"start":{"row":18,"column":9},"end":{"row":18,"column":10},"action":"insert","lines":[" "],"id":277}],[{"start":{"row":18,"column":10},"end":{"row":18,"column":11},"action":"insert","lines":["="],"id":278}],[{"start":{"row":18,"column":11},"end":{"row":18,"column":12},"action":"insert","lines":[" "],"id":279}],[{"start":{"row":18,"column":12},"end":{"row":18,"column":13},"action":"insert","lines":["r"],"id":280}],[{"start":{"row":18,"column":13},"end":{"row":18,"column":14},"action":"insert","lines":["e"],"id":281}],[{"start":{"row":18,"column":14},"end":{"row":18,"column":15},"action":"insert","lines":["q"],"id":282}],[{"start":{"row":18,"column":15},"end":{"row":18,"column":16},"action":"insert","lines":["u"],"id":283}],[{"start":{"row":18,"column":16},"end":{"row":18,"column":17},"action":"insert","lines":["i"],"id":284}],[{"start":{"row":18,"column":12},"end":{"row":18,"column":17},"action":"remove","lines":["requi"],"id":285},{"start":{"row":18,"column":12},"end":{"row":18,"column":23},"action":"insert","lines":["require(\"\")"]}],[{"start":{"row":18,"column":20},"end":{"row":18,"column":22},"action":"remove","lines":["\"\""],"id":286}],[{"start":{"row":18,"column":20},"end":{"row":18,"column":22},"action":"insert","lines":["''"],"id":288}],[{"start":{"row":18,"column":21},"end":{"row":18,"column":22},"action":"insert","lines":["t"],"id":289}],[{"start":{"row":18,"column":22},"end":{"row":18,"column":23},"action":"insert","lines":["s"],"id":290}],[{"start":{"row":18,"column":23},"end":{"row":18,"column":24},"action":"insert","lines":["i"],"id":291}],[{"start":{"row":18,"column":24},"end":{"row":18,"column":25},"action":"insert","lines":["f"],"id":292}],[{"start":{"row":18,"column":25},"end":{"row":18,"column":26},"action":"insert","lines":["y"],"id":293}]]},"ace":{"folds":[],"scrolltop":14,"scrollleft":0,"selection":{"start":{"row":1,"column":32},"end":{"row":1,"column":32},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1473382235000}